<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="jstor">
<title>Analysing n-grams with `jstor` for R • jstor</title>
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://docs.ropensci.org/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Analysing n-grams with `jstor` for R">
<meta property="og:description" content="jstor">
<meta property="og:image" content="https://docs.ropensci.org/jstor/logo.png">
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Matomo --><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css">
<script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js" data-cfasync="false"></script><script src="https://ropensci.org/scripts/matomo.js"></script><noscript><p><img src="https://ropensci.matomo.cloud/matomo.php?idsite=1&amp;rec=1" style="border:0;" alt=""></p></noscript>
<!-- End Matomo Code -->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    <a href="https://ropensci.org" class="external-link"><img src="https://ropensci.org/img/icon_short_white.svg" id="hexlogo" alt="rOpenSci"></a>
    <a class="navbar-brand me-2" href="../index.html">jstor</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.3.11</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-vignettes">Vignettes</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-vignettes">
    <a class="dropdown-item" href="../articles/introduction.html">Introduction</a>
    <a class="dropdown-item" href="../articles/automating-file-import.html">Automating File Import</a>
    <a class="dropdown-item" href="../articles/known-quirks.html">Known Data Quirks</a>
  </div>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../articles/analysing-n-grams.html">Case Study - Analysing Ngrams</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/tklebel/jstor">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Analysing n-grams with `jstor` for R</h1>
                        <h4 data-toc-skip class="author">Thomas Klebel</h4>
            
            <h4 data-toc-skip class="date">2019-12-22</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/jstor/blob/HEAD/vignettes/analysing-n-grams.Rmd" class="external-link"><code>vignettes/analysing-n-grams.Rmd</code></a></small>
      <div class="d-none name"><code>analysing-n-grams.Rmd</code></div>
    </div>

    
    
<p>The service <a href="http://www.jstor.org/dfr/" class="external-link">DfR</a> by JSTOR offers several ways for text analysis of scientific articles. In this vignette I will demonstrate how to analyse n-grams which DfR delivers.</p>
<p>Let’s suppose, we are interested in the topic of “inequality” within the discipline of sociology. Social inequality can be considered a prime subject of sociological inquiry. In order to gain some context on the subject, we might be interested to analyse frequently occurring terms. DfR offers different grades of tokenization: n-grams for 1-3 words, e.g. unigrams, bigrams and trigrams. In case you are unfamiliar with the analysis of tokenized text, you could read the first few paragraphs of chapters 1 and 4 in <a href="https://www.tidytextmining.com" class="external-link uri">https://www.tidytextmining.com</a> as an introduction.</p>
<p>Our analysis starts at the main page of <a href="http://www.jstor.org/dfr/" class="external-link">DfR</a>. We create a dataset<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;An introduction on how to create datasets can be found on the page of DfR: &lt;a href="http://www.jstor.org/dfr/about/creating-datasets" class="external-link uri"&gt;http://www.jstor.org/dfr/about/creating-datasets&lt;/a&gt;&lt;/p&gt;'><sup>1</sup></a> by searching for “inequality” and selecting “sociology” as our subject. To trim down the number of articles, we only select articles from 1997 to 2017. After logging in/creating an account, we select unigrams and bigrams. The resulting <code>.zip</code>-file can be downloaded from the email which DfR sends.</p>
<p>Up-front, we need to load some packages. <code>jstor</code> is available from CRAN, so it can be installed via <code>install.packages("jstor")</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/jstor">jstor</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://future.futureverse.org" class="external-link">future</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># set a lighter theme for plots</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html" class="external-link">theme_set</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># import files in parallel</span></span>
<span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="va">multisession</span><span class="op">)</span></span></code></pre></div>
<p>With the latest version of <code>jstor</code> we can now directly import files from a zip archive. We only need to specify, where the zip archive is located, which parts we want to extract, and where the resulting files should be saved.</p>
<p>Before importing data, we can take a quick look at the contents of each archive with <code><a href="../reference/jst_preview_zip.html">jst_preview_zip()</a></code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/jst_preview_zip.html">jst_preview_zip</a></span><span class="op">(</span><span class="st">"part1.zip"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## # A tibble: 4 x 3</span></span>
<span><span class="co">##   type     meta_type           n</span></span>
<span><span class="co">##   &lt;chr&gt;    &lt;chr&gt;           &lt;int&gt;</span></span>
<span><span class="co">## 1 metadata journal_article 19782</span></span>
<span><span class="co">## 2 ngram1   ngram1          19759</span></span>
<span><span class="co">## 3 ngram2   ngram2          19739</span></span>
<span><span class="co">## 4 ngram3   ngram3          19727</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/jst_preview_zip.html">jst_preview_zip</a></span><span class="op">(</span><span class="st">"part2.zip"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## # A tibble: 4 x 3</span></span>
<span><span class="co">##   type     meta_type           n</span></span>
<span><span class="co">##   &lt;chr&gt;    &lt;chr&gt;           &lt;int&gt;</span></span>
<span><span class="co">## 1 metadata journal_article  4127</span></span>
<span><span class="co">## 2 ngram1   ngram1           4151</span></span>
<span><span class="co">## 3 ngram2   ngram2           4172</span></span>
<span><span class="co">## 4 ngram3   ngram3           4184</span></span></code></pre></div>
<p>Although we could import all ngrams at this point, this would be extremely inefficient. It is thus best first to decide, which articles we want to analyze, and import the corresponding ngram-files afterwards.</p>
<p>The following code assumes that you follow a workflow organised around projects within RStudio (refer to <a href="http://r4ds.had.co.nz/workflow-projects.html" class="external-link uri">http://r4ds.had.co.nz/workflow-projects.html</a> for further information).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">import_spec</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/jst_define_import.html">jst_define_import</a></span><span class="op">(</span>article <span class="op">=</span> <span class="va">jst_get_article</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/jst_import.html">jst_import_zip</a></span><span class="op">(</span><span class="st">"part1.zip"</span>, import_spec <span class="op">=</span> <span class="va">import_spec</span>, out_file <span class="op">=</span> <span class="st">"part1"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/jst_import.html">jst_import_zip</a></span><span class="op">(</span><span class="st">"part2.zip"</span>, import_spec <span class="op">=</span> <span class="va">import_spec</span>, out_file <span class="op">=</span> <span class="st">"part2"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#&gt; Processing files for journal_article with functions jst_get_article</span></span>
<span><span class="co">#&gt; Processing chunk 1/1</span></span>
<span><span class="co">#&gt;  Progress: ───────────────────────────────────────────────────────────── 100%</span></span></code></pre></div>
<p>Since <code>jst_import_zip</code> writes the results to disk, we need to read the metadata from the newly created file. This is made easy by <code>jst_re_import</code> which ensures, that the data are read with the right column types.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">imported_metadata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"part1_journal_article_jst_get_article-1.csv"</span>,</span>
<span>                       <span class="st">"part2_journal_article_jst_get_article-1.csv"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html" class="external-link">map_df</a></span><span class="op">(</span><span class="va">jst_re_import</span><span class="op">)</span></span>
<span><span class="va">imported_metadata</span></span></code></pre></div>
<pre><code><span><span class="co">## # A tibble: 23,909 x 19</span></span>
<span><span class="co">##    file_name journal_doi journal_jcode journal_pub_id journal_title</span></span>
<span><span class="co">##    &lt;chr&gt;     &lt;chr&gt;       &lt;chr&gt;         &lt;chr&gt;          &lt;chr&gt;        </span></span>
<span><span class="co">##  1 journal-… &lt;NA&gt;        &lt;NA&gt;          amerjsoci      American Jou…</span></span>
<span><span class="co">##  2 journal-… &lt;NA&gt;        &lt;NA&gt;          amerjsoci      American Jou…</span></span>
<span><span class="co">##  3 journal-… &lt;NA&gt;        &lt;NA&gt;          amerjsoci      American Jou…</span></span>
<span><span class="co">##  4 journal-… &lt;NA&gt;        &lt;NA&gt;          amerjsoci      American Jou…</span></span>
<span><span class="co">##  5 journal-… &lt;NA&gt;        &lt;NA&gt;          amerjsoci      American Jou…</span></span>
<span><span class="co">##  6 journal-… &lt;NA&gt;        &lt;NA&gt;          amerjsoci      American Jou…</span></span>
<span><span class="co">##  7 journal-… &lt;NA&gt;        &lt;NA&gt;          amerjsoci      American Jou…</span></span>
<span><span class="co">##  8 journal-… &lt;NA&gt;        &lt;NA&gt;          amerjsoci      American Jou…</span></span>
<span><span class="co">##  9 journal-… &lt;NA&gt;        &lt;NA&gt;          amerjsoci      American Jou…</span></span>
<span><span class="co">## 10 journal-… &lt;NA&gt;        &lt;NA&gt;          amerjsoci      American Jou…</span></span>
<span><span class="co">## # … with 23,899 more rows, and 14 more variables: article_doi &lt;chr&gt;,</span></span>
<span><span class="co">## #   article_pub_id &lt;chr&gt;, article_jcode &lt;chr&gt;, article_type &lt;chr&gt;,</span></span>
<span><span class="co">## #   article_title &lt;chr&gt;, volume &lt;chr&gt;, issue &lt;chr&gt;, language &lt;chr&gt;,</span></span>
<span><span class="co">## #   pub_day &lt;chr&gt;, pub_month &lt;chr&gt;, pub_year &lt;int&gt;, first_page &lt;chr&gt;,</span></span>
<span><span class="co">## #   last_page &lt;chr&gt;, page_range &lt;chr&gt;</span></span></code></pre>
<div class="section level2">
<h2 id="cleaning-the-data">Cleaning the data<a class="anchor" aria-label="anchor" href="#cleaning-the-data"></a>
</h2>
<p>Data from DfR is inherently messy. To fix a few common issues, we can use <code><a href="../reference/jst_augment.html">jst_augment()</a></code>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">imported_metadata</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/jst_augment.html">jst_augment</a></span><span class="op">(</span><span class="va">imported_metadata</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>For more information on common quirks with data from DfR and how to deal with them, take a look at the <code><a href="../articles/known-quirks.html">vignette("known-quirks")</a></code>.</p>
</div>
<div class="section level2">
<h2 id="exploration">Exploration<a class="anchor" aria-label="anchor" href="#exploration"></a>
</h2>
<p>Before diving into the analysis of n-grams, we might wish to take an exploratory look at our metadata. The first thing to look at are the types of articles.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">imported_metadata</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">article_type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html" class="external-link">coord_flip</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figure/article-types-1.png" alt=""><p class="caption">plot of chunk article-types</p>
</div>
<p>We can see, that the majority of articles are proper “research-articles”, which together with book-reviews and miscellaneous articles amount to ~99% of all articles.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">imported_metadata</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">article_type</span>, sort <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>perc <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/percent_format.html" class="external-link">percent</a></span><span class="op">(</span><span class="va">n</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## # A tibble: 14 x 3</span></span>
<span><span class="co">##    article_type         n perc </span></span>
<span><span class="co">##    &lt;chr&gt;            &lt;int&gt; &lt;chr&gt;</span></span>
<span><span class="co">##  1 research-article 16289 68.1%</span></span>
<span><span class="co">##  2 book-review       4552 19.0%</span></span>
<span><span class="co">##  3 misc              2850 11.9%</span></span>
<span><span class="co">##  4 other               89 0.4% </span></span>
<span><span class="co">##  5 in-brief            38 0.2% </span></span>
<span><span class="co">##  6 discussion          31 0.1% </span></span>
<span><span class="co">##  7 review-article      25 0.1% </span></span>
<span><span class="co">##  8 announcement        12 0.1% </span></span>
<span><span class="co">##  9 index                9 0.0% </span></span>
<span><span class="co">## 10 editorial            7 0.0% </span></span>
<span><span class="co">## 11 introduction         3 0.0% </span></span>
<span><span class="co">## 12 news                 2 0.0% </span></span>
<span><span class="co">## 13 bibliography         1 0.0% </span></span>
<span><span class="co">## 14 letter               1 0.0%</span></span></code></pre>
<p>We must be cautious, however, when using this variable to distinguish articles into categories. In this instance, we have “research-articles” which are actually book-reviews:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">imported_metadata</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">article_type</span> <span class="op">==</span> <span class="st">"research-article"</span> <span class="op">&amp;</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">article_title</span>, <span class="st">"Book"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">file_name</span>, <span class="va">article_title</span>, <span class="va">pub_year</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## # A tibble: 190 x 3</span></span>
<span><span class="co">##    file_name                      article_title pub_year</span></span>
<span><span class="co">##    &lt;chr&gt;                          &lt;chr&gt;            &lt;int&gt;</span></span>
<span><span class="co">##  1 journal-article-10.1086_210272 Book Reviews      1999</span></span>
<span><span class="co">##  2 journal-article-10.1086_210273 Book Reviews      1999</span></span>
<span><span class="co">##  3 journal-article-10.1086_210274 Book Reviews      1999</span></span>
<span><span class="co">##  4 journal-article-10.1086_210275 Book Reviews      1999</span></span>
<span><span class="co">##  5 journal-article-10.1086_210276 Book Reviews      1999</span></span>
<span><span class="co">##  6 journal-article-10.1086_210278 Book Reviews      1999</span></span>
<span><span class="co">##  7 journal-article-10.1086_210279 Book Reviews      1999</span></span>
<span><span class="co">##  8 journal-article-10.1086_210280 Book Reviews      1999</span></span>
<span><span class="co">##  9 journal-article-10.1086_210281 Book Reviews      1999</span></span>
<span><span class="co">## 10 journal-article-10.1086_210283 Book Reviews      1999</span></span>
<span><span class="co">## # … with 180 more rows</span></span></code></pre>
<p>For the current demonstration, we want to restrict the type of articles to research articles, therefore we need to take steps to remove book reviews and other miscellaneous articles: First, filter by <code>article_type</code>, then remove articles where the title starts with “Book Review”.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">research_articles</span> <span class="op">&lt;-</span> <span class="va">imported_metadata</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">article_type</span> <span class="op">==</span> <span class="st">"research-article"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">article_title</span>, <span class="st">"^Book Review"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="the-moving-wall---filtering-articles-by-time">The moving wall - filtering articles by time<a class="anchor" aria-label="anchor" href="#the-moving-wall---filtering-articles-by-time"></a>
</h3>
<p>Since JSTOR has a <a href="https://support.jstor.org/hc/en-us/articles/115004879547-JSTOR-s-Moving-Wall-Archive-vs-Current-Definitions" class="external-link">moving wall</a>, we should take a look at the number of articles per year in our dataset.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">research_articles</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">pub_year</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span><span class="op">)</span> </span></code></pre></div>
<div class="figure">
<img src="figure/publications-per-year-1.png" alt=""><p class="caption">plot of chunk publications-per-year</p>
</div>
<p>From this graph we can see an increase in research articles until 2010, after which the number of articles first tapers off, and then drops off sharply. For this reason we should exclude articles at least from 2015 onward, since the sample might get quite biased toward specific journals.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">without_wall</span> <span class="op">&lt;-</span> <span class="va">research_articles</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">pub_year</span> <span class="op">&lt;</span> <span class="fl">2015</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="flagship-journals---filtering-articles-by-journal">Flagship journals - filtering articles by journal<a class="anchor" aria-label="anchor" href="#flagship-journals---filtering-articles-by-journal"></a>
</h3>
<p>Since the amount of articles is still rather large for this demonstration, we could select only a few journals. Here, we will look at articles from two leading journals within the discipline, “American Journal of Sociology” and “American Sociological Review”.</p>
<p>Since we cleaned the identifiers for journals with <code>jst_augment</code> earlier, we can select our two flagship-journals very easily.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">flagship_journals</span> <span class="op">&lt;-</span> <span class="va">without_wall</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">journal_id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"amerjsoci"</span>, <span class="st">"amersocirevi"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="importing-bigrams">Importing bigrams<a class="anchor" aria-label="anchor" href="#importing-bigrams"></a>
</h2>
<blockquote>
<p>Disclaimer: Much of the following analysis was inspired by the book “Text Mining with R” by Julia Silge and David Robinson: <a href="https://www.tidytextmining.com" class="external-link uri">https://www.tidytextmining.com</a></p>
</blockquote>
<p>For this demonstration we will look at bigrams to find the most common pairs of words. Until now, we were only dealing with the metadata, therefore we need a way to link our reduced dataset to the bigram files from DfR. The directory structure for deliveries from DfR looks something like this:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">receipt</span><span class="op">-</span><span class="va">id</span><span class="op">-</span><span class="fl">123456</span><span class="op">-</span><span class="va">part</span><span class="op">-</span><span class="fl">001</span></span>
<span>  <span class="op">-</span><span class="op">-</span> <span class="va">metadata</span></span>
<span>    <span class="op">-</span><span class="op">-</span> <span class="va">journal_article_foo.xml</span></span>
<span>       <span class="va">.</span></span>
<span>       <span class="va">.</span></span>
<span>       <span class="va">.</span></span>
<span>  <span class="op">-</span><span class="op">-</span> <span class="va">ngram2</span></span>
<span>    <span class="op">-</span><span class="op">-</span> <span class="va">journal_article_foo.txt</span></span>
<span>       <span class="va">.</span></span>
<span>       <span class="va">.</span></span>
<span>       <span class="va">.</span></span>
<span><span class="va">receipt</span><span class="op">-</span><span class="va">id</span><span class="op">-</span><span class="fl">123456</span><span class="op">-</span><span class="va">part</span><span class="op">-</span><span class="fl">002</span></span>
<span>  <span class="op">-</span><span class="op">-</span> <span class="va">metadata</span></span>
<span>    <span class="op">-</span><span class="op">-</span> <span class="va">journal_article_bar.xml</span></span>
<span>       <span class="va">.</span></span>
<span>       <span class="va">.</span></span>
<span>       <span class="va">.</span></span>
<span>  <span class="op">-</span><span class="op">-</span> <span class="va">ngram2</span></span>
<span>    <span class="op">-</span><span class="op">-</span> <span class="va">journal_article_bar.txt</span></span>
<span>       <span class="va">.</span></span>
<span>       <span class="va">.</span></span>
<span>       <span class="va">.</span></span></code></pre></div>
<p>From this structure we can see, that the file name can serve as an identifier to match articles and n-grams, since it is similar between metadata and n-grams.</p>
<p>To make importing a subset of ngrams more convenient, we can use <code>jst_subset_ngrams</code>. This function returns a list of “zip-locations”, which <code>jst_get_ngram</code> can read.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ngram_selection</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/jst_subset_ngrams.html">jst_subset_ngrams</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"part1.zip"</span>, <span class="st">"part2.zip"</span><span class="op">)</span>, <span class="st">"ngram2"</span>,</span>
<span>                                    <span class="va">flagship_journals</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Error in utils::unzip(zip_archive, list = TRUE): zip Datei 'part2.zip' kann nicht geöffnet werden</span></span></code></pre>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ngram_selection</span>, <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Error in head(ngram_selection, 2): Objekt 'ngram_selection' nicht gefunden</span></span></code></pre>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ngram_selection</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/jst_subset_ngrams.html">jst_subset_ngrams</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"part1.zip"</span>, <span class="st">"part2.zip"</span><span class="op">)</span>, <span class="st">"ngram2"</span>,</span>
<span>                                    <span class="va">flagship_journals</span><span class="op">)</span></span>
<span></span>
<span><span class="va">imported_bigrams</span> <span class="op">&lt;-</span> <span class="va">ngram_selection</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">furrr</span><span class="fu">::</span><span class="fu"><a href="https://furrr.futureverse.org/reference/future_map.html" class="external-link">future_map_dfr</a></span><span class="op">(</span><span class="va">jst_get_ngram</span><span class="op">)</span></span></code></pre></div>
<p>From the 872 articles in our two flagship journals we now have 6,729,813 bigrams. The bigrams are calculated by JSTOR for each article independently. In order to reduce the sample to the most common bigrams, we have two choices: either to include only terms which occur <em>within each</em> article a given amount of times, or to include terms which occur <em>within all</em> articles a given amount of times. By only including terms which occur more than 5 times in each article, we can drastically reduce the number of terms. However, we might miss some important ones: there might be terms which do not occur repeatedly within articles, but are present in all of them.</p>
<p>For demonstration purposes we are a bit restrictive and include only those terms, which occur at least three times per article.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">top_bigrams</span> <span class="op">&lt;-</span> <span class="va">imported_bigrams</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">n</span> <span class="op">&gt;=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="cleaning-up-bigrams">Cleaning up bigrams<a class="anchor" aria-label="anchor" href="#cleaning-up-bigrams"></a>
</h3>
<p>When constructing n-grams, DfR uses a stop-word list, which is quite limited <a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;for more information see the &lt;a href="http://www.jstor.org/dfr/about/technical-specifications" class="external-link"&gt;technical specifications&lt;/a&gt; on their page&lt;/p&gt;'><sup>2</sup></a>. If we would like to restrict the terms a bit further, we could use stopwords from <code>tidytext</code>:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/juliasilge/tidytext" class="external-link">tidytext</a></span><span class="op">)</span></span>
<span><span class="va">bigrams_separated</span> <span class="op">&lt;-</span> <span class="va">top_bigrams</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html" class="external-link">separate</a></span><span class="op">(</span><span class="va">bigrams</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"word1"</span>, <span class="st">"word2"</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">" "</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bigrams_filtered</span> <span class="op">&lt;-</span> <span class="va">bigrams_separated</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">word1</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">stop_words</span><span class="op">$</span><span class="va">word</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">word2</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">stop_words</span><span class="op">$</span><span class="va">word</span><span class="op">)</span></span></code></pre></div>
<p>After removing the stopwords we need to consider the fact, that our bigrams were created for each article on its own. In order to analyse them together, we need to count the terms for all articles in combination.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bigram_counts</span> <span class="op">&lt;-</span> <span class="va">bigrams_filtered</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">word1</span>, <span class="va">word2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bigram_counts</span></span></code></pre></div>
<pre><code><span><span class="co">## # A tibble: 106,706 x 3</span></span>
<span><span class="co">## # Groups:   word1 [18,152]</span></span>
<span><span class="co">##    word1        word2            n</span></span>
<span><span class="co">##    &lt;chr&gt;        &lt;chr&gt;        &lt;int&gt;</span></span>
<span><span class="co">##  1 american     sociological  9593</span></span>
<span><span class="co">##  2 sociological review        9198</span></span>
<span><span class="co">##  3 university   press         4603</span></span>
<span><span class="co">##  4 labor        market        3555</span></span>
<span><span class="co">##  5 american     journal       3273</span></span>
<span><span class="co">##  6 9            7             3270</span></span>
<span><span class="co">##  7 7            6             3260</span></span>
<span><span class="co">##  8 10           9             3230</span></span>
<span><span class="co">##  9 amsmath      amsxtra       3192</span></span>
<span><span class="co">## 10 begin        document      3192</span></span>
<span><span class="co">## # … with 106,696 more rows</span></span></code></pre>
<p>From the first few terms we can see, that there are still many terms which are not very interesting for our analysis. The terms “american” and “sociological” are simply part of the title of a journal we selected (American Sociological Review). To clean the terms up, we can employ different approaches. One is to simply filter the terms we wish to exclude:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bigram_counts_clean</span> <span class="op">&lt;-</span> <span class="va">bigram_counts</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unite.html" class="external-link">unite</a></span><span class="op">(</span><span class="va">bigram</span>, <span class="va">word1</span>, <span class="va">word2</span>, sep <span class="op">=</span> <span class="st">" "</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">bigram</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"american sociological"</span>, <span class="st">"sociological review"</span>,</span>
<span>                        <span class="st">"university press"</span>, <span class="st">"american journal"</span>,</span>
<span>                        <span class="st">"journal sociology"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html" class="external-link">separate</a></span><span class="op">(</span><span class="va">bigram</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"word1"</span>, <span class="st">"word2"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>We will look at another approach after plotting our bigrams.</p>
</div>
</div>
<div class="section level2">
<h2 id="visualize-relationships">Visualize relationships<a class="anchor" aria-label="anchor" href="#visualize-relationships"></a>
</h2>
<p>When analyzing bigrams, we might want to look at the relationships between common terms. For this we can leverage the power of <a href="http://igraph.org/r/" class="external-link">igraph</a> and <a href="https://cran.r-project.org/web/packages/ggraph/index.html" class="external-link">ggraph</a>.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r.igraph.org/" class="external-link">igraph</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggraph.data-imaginist.com" class="external-link">ggraph</a></span><span class="op">)</span></span></code></pre></div>
<p>First, we only keep the most common terms and then convert our <code>data.frame</code> to an <code>igraph</code>-object. <a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;If you are unfamiliar with graph theory, just take a look at Wikipedia: &lt;a href="https://en.wikipedia.org/wiki/Graph_theory" class="external-link"&gt;Graph Theory&lt;/a&gt;.&lt;/p&gt;'><sup>3</sup></a></p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bigram_graph</span> <span class="op">&lt;-</span> <span class="va">bigram_counts_clean</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">n</span> <span class="op">&gt;</span> <span class="fl">500</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">graph_from_data_frame</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bigram_graph</span></span></code></pre></div>
<pre><code><span><span class="co">## IGRAPH 755e99b DN-- 170 161 -- </span></span>
<span><span class="co">## + attr: name (v/c), n (e/n)</span></span>
<span><span class="co">## + edges from 755e99b (vertex names):</span></span>
<span><span class="co">##  [1] labor                 -&gt;market   9                     -&gt;7       </span></span>
<span><span class="co">##  [3] 7                     -&gt;6        10                    -&gt;9       </span></span>
<span><span class="co">##  [5] amsmath               -&gt;amsxtra  begin                 -&gt;document</span></span>
<span><span class="co">##  [7] declaremathsizes      -&gt;10       declaretextfontcommand-&gt;textcyr </span></span>
<span><span class="co">##  [9] documentclass         -&gt;aastex   encodingdefault       -&gt;ot2     </span></span>
<span><span class="co">## [11] newcommand            -&gt;cyr      ot1                   -&gt;fontenc </span></span>
<span><span class="co">## [13] ot2                   -&gt;ot1      pagestyle             -&gt;empty   </span></span>
<span><span class="co">## [15] portland              -&gt;xspace  </span></span>
<span><span class="co">## + ... omitted several edges</span></span></code></pre>
<p>For plotting, we will use a simple plotting function, adapted from <a href="https://www.tidytextmining.com/ngrams.html#visualizing-a-network-of-bigrams-with-ggraph" class="external-link uri">https://www.tidytextmining.com/ngrams.html#visualizing-a-network-of-bigrams-with-ggraph</a>.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plot_bigrams</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">igraph_df</span>, <span class="va">seed</span> <span class="op">=</span> <span class="fl">2016</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="va">seed</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">a</span> <span class="op">&lt;-</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/arrow.html" class="external-link">arrow</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"closed"</span>, length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">.15</span>, <span class="st">"inches"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu">ggraph</span><span class="op">(</span><span class="va">igraph_df</span>, layout <span class="op">=</span> <span class="st">"fr"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_edge_link</span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>edge_alpha <span class="op">=</span> <span class="va">n</span><span class="op">)</span>, show.legend <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                   arrow <span class="op">=</span> <span class="va">a</span>, end_cap <span class="op">=</span> <span class="fu">circle</span><span class="op">(</span><span class="fl">.07</span>, <span class="st">'inches'</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_node_point</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"lightblue"</span>, size <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_node_text</span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">name</span><span class="op">)</span>, repel <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme_graph</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plot_bigrams</span><span class="op">(</span><span class="va">bigram_graph</span><span class="op">)</span></span></code></pre></div>
<p><img src="figure/first-bigram-graph-1.png" alt="plot of chunk first-bigram-graph"> Very obvious is a group of nodes which are not relevant to the topic of inequality. They come from LaTeX documents and somehow made their way into the original dataset. However, since they are more common than most of the other terms, they are quite easy to remove. We can look at the nodes/vertices of our graph with <code>V(bigram_graph)</code>.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">V</span><span class="op">(</span><span class="va">bigram_graph</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## + 170/170 vertices, named, from 755e99b:</span></span>
<span><span class="co">##   [1] labor                  9                      7                     </span></span>
<span><span class="co">##   [4] 10                     amsmath                begin                 </span></span>
<span><span class="co">##   [7] declaremathsizes       declaretextfontcommand documentclass         </span></span>
<span><span class="co">##  [10] encodingdefault        newcommand             ot1                   </span></span>
<span><span class="co">##  [13] ot2                    pagestyle              portland              </span></span>
<span><span class="co">##  [16] renewcommand           rmdefault              sfdefault             </span></span>
<span><span class="co">##  [19] textcyr                usepackage             6                     </span></span>
<span><span class="co">##  [22] aastex                 amsbsy                 amsfonts              </span></span>
<span><span class="co">##  [25] amssymb                amsxtra                bm                    </span></span>
<span><span class="co">##  [28] cyr                    document               empty                 </span></span>
<span><span class="co">## + ... omitted several vertices</span></span></code></pre>
<p>The first node, “labor”, is relevant to us, but all other nodes from 2 to at least 40 are clearly irrelevant. We can remove them by simple subtraction:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bigram_graph_clean</span> <span class="op">&lt;-</span> <span class="va">bigram_graph</span> <span class="op">-</span> <span class="fl">2</span><span class="op">:</span><span class="fl">40</span></span>
<span><span class="va">bigram_graph_clean</span></span></code></pre></div>
<pre><code><span><span class="co">## IGRAPH 3272619 DN-- 131 105 -- </span></span>
<span><span class="co">## + attr: name (v/c), n (e/n)</span></span>
<span><span class="co">## + edges from 3272619 (vertex names):</span></span>
<span><span class="co">##  [1] labor     -&gt;market     labor     -&gt;force      0         -&gt;0         </span></span>
<span><span class="co">##  [4] table     -&gt;2          1         -&gt;1          income    -&gt;inequality</span></span>
<span><span class="co">##  [7] black     -&gt;white      table     -&gt;1          table     -&gt;3         </span></span>
<span><span class="co">## [10] social    -&gt;capital    model     -&gt;1          model     -&gt;2         </span></span>
<span><span class="co">## [13] african   -&gt;american   0         -&gt;1          human     -&gt;capital   </span></span>
<span><span class="co">## [16] african   -&gt;americans  table     -&gt;4          1         -&gt;2         </span></span>
<span><span class="co">## [19] model     -&gt;3          racial    -&gt;ethnic     individual-&gt;level     </span></span>
<span><span class="co">## [22] civil     -&gt;rights     cross     -&gt;national  </span></span>
<span><span class="co">## + ... omitted several edges</span></span></code></pre>
<p>Another apparent group is a combination of “table” or “figure” with digits. This evidently comes from tables or figures in the papers and might suggest, that the articles in our sample quite frequently employ quantitative methods, where figures and tables are very common. For the analysis at hand however, we might remove them, along with a few other irrelevant terms.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bigram_graph_clean</span> <span class="op">&lt;-</span> <span class="va">bigram_graph_clean</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"table"</span>, <span class="st">"model"</span>,</span>
<span>                                             <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>,</span>
<span>                                             <span class="st">"xd"</span>, <span class="st">"rh"</span>, <span class="st">"landscape"</span>, <span class="st">"00"</span>,</span>
<span>                                             <span class="st">"figure"</span>, <span class="st">"review"</span>, <span class="st">"79"</span>,</span>
<span>                                             <span class="st">"http"</span>, <span class="st">"www"</span>, <span class="st">"000"</span>, <span class="st">"01"</span><span class="op">)</span></span></code></pre></div>
<p>After cleaning up a bit, we can take a fresh look at our bigrams.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plot_bigrams</span><span class="op">(</span><span class="va">bigram_graph_clean</span>, <span class="fl">234</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figure/second-bigram-graph-1.png" alt=""><p class="caption">plot of chunk second-bigram-graph</p>
</div>
<p>The figure is still far from perfect (“eco” -&gt; “nomic” should clearly be one term), but we can begin to analyse our network.</p>
<p>The most frequent bigrams are now “labor market”, “labor force”, and “income inequality”, which are not very surprising given that most individuals in capitalist societies need to supply their work in exchange for income. For this reason, the labor market and its stratification is a prime subject of the sociological inquiry into inequality. A few further key dimensions of sociological analysis are apparent from the graph: gender, race/ethnicity, occupational and socioeconomic status. That we find many terms to be associated with the term “social” seems quite likely given the discipline’s subject.</p>
<p>At least two surprising results should be pointed out. First, it is not evident how the terms “ethnic” and “racial” are connected. They do not form a typical term like “social capital”, “middle class” or similar, nor could they be considered a dichotomy like “black” and “white” which are often included in tables from regressions. From a theoretical point of view, they have slightly different meanings but are frequently being used as synonyms. Second, there is a group of nodes around the term “university”: university -&gt; chicago, university -&gt; california, harvard -&gt; university, etc. At least two explanations seem plausible: either, many books are being cited which are in some way associated with those universities (“The University of Chicago Press” is the largest university press in the United States), or many researchers who publish in the two flagship-journals we selected are affiliated with those four universities: Harvard, Chicago, Cambridge and California. At least partly the prominence of university -&gt; chicago -&gt; press might be due to the fact, that it is the publisher of the American Journal of Sociology, and therefore included in each article by this journal.</p>
<p>Altogether, these findings will not be surprising to well-educated sociologists. Almost all bigrams in the graph are common concepts or terms within the discipline. Most importantly, very often those concepts and terms comprise two single words, as in “social science”, “social structure”, “social networks”. Two approaches might be useful to examine, <em>how</em> these concepts are being used:</p>
<ol style="list-style-type: decimal">
<li>Analyzing trigrams. It could be the case, that many of the above concepts would show up in combination with more interesting terms, if we were to analyze combinations of three words.</li>
<li>Another approach would be to first analyze data for bigrams as above, determining the core concepts of a field. In a second step, one could search for those core concepts in the raw data files and extract adjacent terms. This would not be possible with the default deliveries from DfR however, since full-text content is only available through a dedicated agreement.</li>
</ol>
</div>
<div class="section level2">
<h2 id="comparison-over-time">Comparison over time<a class="anchor" aria-label="anchor" href="#comparison-over-time"></a>
</h2>
<p>Besides looking at the overall relationship of bigrams, we could be interested in the development over time of specific terms. Here, we want to look at how often “labor market” and “income inequality” appear from year to year.</p>
<p>For this, we need to join our bigrams with the metadata.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">time_bigrams</span> <span class="op">&lt;-</span> <span class="va">top_bigrams</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">flagship_journals</span>, by <span class="op">=</span> <span class="st">"file_name"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">bigrams</span>, <span class="va">n</span>, <span class="va">pub_year</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">time_bigrams</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##             bigrams  n pub_year</span></span>
<span><span class="co">## 1    private sector 92     1998</span></span>
<span><span class="co">## 2 market transition 68     1998</span></span>
<span><span class="co">## 3               3 t 38     1998</span></span>
<span><span class="co">## 4              1 00 37     1998</span></span>
<span><span class="co">## 5 journal sociology 34     1998</span></span>
<span><span class="co">## 6      state sector 34     1998</span></span></code></pre>
<p>Again, we need to sum up the counts, but this time grouped by year:</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">time_bigrams</span> <span class="op">&lt;-</span> <span class="va">time_bigrams</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">bigrams</span>, <span class="va">pub_year</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">time_bigrams</span></span></code></pre></div>
<pre><code><span><span class="co">## # A tibble: 248,725 x 3</span></span>
<span><span class="co">## # Groups:   bigrams [157,266]</span></span>
<span><span class="co">##    bigrams               pub_year     n</span></span>
<span><span class="co">##    &lt;chr&gt;                    &lt;int&gt; &lt;int&gt;</span></span>
<span><span class="co">##  1 0 0                       2004  1071</span></span>
<span><span class="co">##  2 et al                     2014   916</span></span>
<span><span class="co">##  3 women s                   2006   885</span></span>
<span><span class="co">##  4 american sociological     2014   860</span></span>
<span><span class="co">##  5 sociological review       2014   814</span></span>
<span><span class="co">##  6 u s                       2014   793</span></span>
<span><span class="co">##  7 et al                     2011   792</span></span>
<span><span class="co">##  8 et al                     2013   748</span></span>
<span><span class="co">##  9 et al                     2010   691</span></span>
<span><span class="co">## 10 et al                     2012   687</span></span>
<span><span class="co">## # … with 248,715 more rows</span></span></code></pre>
<p>We now only keep the two terms of interest and plot them in a simple chart.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># filter the terms of interest</span></span>
<span><span class="va">time_comparison</span> <span class="op">&lt;-</span> <span class="va">time_bigrams</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">bigrams</span> <span class="op">==</span> <span class="st">"labor market"</span> <span class="op">|</span> <span class="va">bigrams</span> <span class="op">==</span> <span class="st">"income inequality"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">time_comparison</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">pub_year</span>, <span class="va">n</span>, colour <span class="op">=</span> <span class="va">bigrams</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/pretty_breaks.html" class="external-link">pretty_breaks</a></span><span class="op">(</span><span class="fl">7</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figure/bigrams-over-time-1.png" alt=""><p class="caption">plot of chunk bigrams-over-time</p>
</div>
<p>In this instance, the plot does not reveal trends over time-the frequency of the terms is fluctuating a lot but staying on a similar level. Single spikes of term frequency for specific years (for example income inequality in 2011) could stem from special issues being explicitly concerned with income inequality, although a quick glance at the corresponding issues invalidates this hypothesis.</p>
</div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><!-- begin footer --><div class="footer">
    <div class="container">
        <div class="row start top-4 bottom-8">
            <div class="col-2"> <img id="footerlogo" src="https://ropensci.org/img/icon_short_white.svg">
</div>
            <div class="col-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="https://github.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-github"></div></a>
                        <a href="https://github.com/ropenscilabs" target="_blank" class="external-link"><div class="icon fa fa-flask"></div></a>
                        <a href="https://hachyderm.io/@ropensci" target="_blank" class="external-link"><div class="icon fab fa-mastodon"></div></a>
                        <a href="https://vimeo.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-vimeo"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">About</h5>
                            <li><a href="https://ropensci.org/about" class="external-link">About rOpenSci</a></li>
                            <li><a href="https://ropensci.org/software-review" class="external-link">Software Review</a></li>
                            <li><a href="https://ropensci.org/about#team" class="external-link">Our Team</a></li>
                            <li><a href="https://ropensci.org/careers" class="external-link">Jobs</a></li>
                            <li><a href="https://ropensci.org/donate" class="external-link">Donate</a></li>
                            <li><a href="https://ropensci.org/contact" class="external-link">Contact Us</a></li>
                        </ul>
</div>
                    <div class="col-md-3 col-sm-4">
                        <ul>
<h5 class="bottom-2">Community</h5>
                            <li><a href="https://ropensci.org/community/" class="external-link">Our Community</a></li>
                            <li><a href="https://ropensci.org/commcalls/" class="external-link">Community calls</a></li>
                            <li><a href="https://ropensci.org/events/" class="external-link">Events</a></li>
                            <li><a href="https://discuss.ropensci.org/" class="external-link">Join the Discussion</a></li>
                            <li><a href="https://ropensci.org/code-of-conduct" class="external-link">Code of conduct</a></li>
                        </ul>
</div>
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">Resources</h5>
                            <li><a href="https://ropensci.org/packages/" class="external-link">Packages</a></li>
                            <li><a href="https://ropensci.org/usecases/" class="external-link">Use Cases</a></li>
                            <li><a href="https://ropensci.org/talks-papers/" class="external-link">Talks &amp; Publications</a></li>
                            <li><a href="https://docs.ropensci.org/" class="external-link">Documentation</a></li>
                            <li><a href="https://ropensci.org/news/" class="external-link">Newsletter</a></li>
                            <li><a href="https://ropensci.org/how-to-cite-ropensci/" class="external-link">Cite rOpenSci</a></li>
                        </ul>
</div>
                    <div class="col-md-4 col-xs-12">
                        <h5 class="bottom-2"></h5>

                        <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" class="external-link">NumFOCUS</a>.</p>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->


    </footer>
</div>

  

  

  </body>
</html>
